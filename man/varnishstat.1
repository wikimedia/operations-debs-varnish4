.\" Man page generated from reStructuredText.
.
.TH VARNISHSTAT  "" "" ""
.SH NAME
varnishstat \- Varnish Cache statistics
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.sp
varnishstat [\-1] [\-x] [\-j] [\-f field_list] [\-l] [\-n varnish_name] [\-N filename] [\-V] [\-w delay]
.\" TODO: autogenerate this synopsis like the others.
.
.SH DESCRIPTION
.sp
The varnishstat utility displays statistics from a running varnishd(1) instance.
.SH OPTIONS
.sp
The following options are available:
.INDENT 0.0
.TP
.B \-1
Instead of presenting a continuously updated display, print
the statistics to stdout.
.TP
.B \-f
Field inclusion glob. A field glob consists of three parts,
type, ident and name, where ident is optional. Each part can
contain a \(aq*\(aq character at the end to match a prefix. Use
backslash to escape characters. If the argument starts with
\(aq^\(aq it is used as an exclusion glob. Multiple \-f arguments may
be given, and they will be applied in order.
.TP
.B \-l
Lists the available fields to use with the \-f option.
.TP
.B \-n
Specifies the name of the varnishd instance to get logs from.
If \-n is not specified, the host name is used.
.TP
.B \-N
Specify a the filename of a stale VSM instance. When using
this option the abandonment checking is disabled.
.TP
.B \-V
Display the version number and exit.
.TP
.BI \-w \ delay
Wait delay seconds between updates.  The default is 1. Can
also be used with \-1, \-x or \-j for repeated output.
.TP
.B \-x
Displays the result as XML.
.TP
.B \-j
Displays the result as JSON.
.UNINDENT
.SH CURSES MODE
.sp
When neither \-1, \-j or \-x options are given, the application starts up
in curses mode. This shows a continously updated view of the counter
values, along with their description.
.sp
The top area shows process uptime information.
.sp
The center area shows a list of counter values.
.sp
The bottom area shows the description of the currently selected
counter.
.SS Columns
.sp
The following columns are displayed, from left to right:
.INDENT 0.0
.TP
.B Name
The name of the counter
.TP
.B Current
The current value of the counter.
.TP
.B Change
The average per second change over the last update interval.
.TP
.B Average
The average value of this counter over the runtime of the
Varnish daemon, or a period if the counter can\(aqt be averaged.
.TP
.B Avg_10
The moving average over the last 10 update intervals.
.TP
.B Avg_100
The moving average over the last 100 update intervals.
.TP
.B Avg_1000
The moving average over the last 1000 update intervals.
.UNINDENT
.SS Key bindings
.sp
The following keys control the interactive display:
.INDENT 0.0
.TP
.B <UP>
Navigate the counter list one line up.
.TP
.B <DOWN>
Navigate the counter list one line down.
.TP
.B <PAGEUP> or <b>
Navigate the counter list one page up.
.TP
.B <PAGEDOWN> or <SPACE>
Navigate the counter list one page down.
.TP
.B <g>
Go to the top of the counter list.
.TP
.B <G>
Go to the bottom of the counter list.
.TP
.B <d>
Toggle between showing and hiding unseen counters. Unseen
counters are those that has been zero for the entire runtime
of varnishstat. Defaults to hide unseen counters.
.TP
.B <v>
Cycle through the verbosity levels. Defaults to only showing
informational counters.
.TP
.B <q>
Quit.
.TP
.B <CTRL+T>
Sample now.
.UNINDENT
.SH XML OUTPUT
.sp
When using the \-x option, the output is:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
<stat>
  <name>FIELD NAME</name>
  <value>FIELD VALUE</value>
  <description>FIELD DESCRIPTION</description>
</stat>
.ft P
.fi
.UNINDENT
.UNINDENT
.SH JSON OUTPUT
.sp
With \-j the output format is:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
{
  "timestamp": "YYYY\-MM\-DDTHH:mm:SS",
  "client_conn": {
      "value": 0, "flag": "a",
      "description": "Client connections accepted"
  },
  "client_drop": {
      "value": 0, "flag": "a",
      "description": "Connection dropped, no sess/wrk"
  },
  "LCK.backend.creat": {
      "type": "LCK", "ident": "backend", "value": 1,
      "flag": "a", "description": "Created locks"
  },
  [..]
}
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Timestamp is the time when the report was generated by varnishstat.
.sp
Repeated output with \-1, \-x or \-j will have a single empty line (\en) between each block of output.
.SH SEE ALSO
.INDENT 0.0
.IP \(bu 2
varnishd(1)
.IP \(bu 2
varnishhist(1)
.IP \(bu 2
varnishlog(1)
.IP \(bu 2
varnishncsa(1)
.IP \(bu 2
varnishtop(1)
.IP \(bu 2
curses(3)
.UNINDENT
.SH HISTORY
.sp
The varnishstat utility was originally developed by Poul\-Henning Kamp
<\fI\%phk@phk.freebsd.dk\fP> in cooperation with Verdens Gang AS and Varnish
Software AS. Manual page written by Dag\-Erling Sm√∏rgrav, Per Buer,
Lasse Karstensen and Martin Blix Grydeland.
.SH COPYRIGHT
.sp
This document is licensed under the same licence as Varnish
itself. See LICENCE for details.
.INDENT 0.0
.IP \(bu 2
Copyright (c) 2006 Verdens Gang AS
.IP \(bu 2
Copyright (c) 2006\-2014 Varnish Software AS
.UNINDENT
.\" Generated by docutils manpage writer.
.
